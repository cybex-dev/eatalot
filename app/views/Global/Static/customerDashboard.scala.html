@import java.util.List
@import controllers.Application.AppTags.AppCookie.user_type
@import utility.DashboardButton
@import views.html.helper.CSRF
@import views.html.Ordering.masterOrder

@(dashButtons: List[DashboardButton], bodyContent: Html)

@generateDashButton(dashboardButton: DashboardButton, index: Integer) = {
    @stylesheets.apply()
    <div class="col-md-3 col-sm-3 col-xs-6 div-button-hover" id="dashButton@index">
        <a href="@CSRF(dashboardButton.link)">
            <div class="alert @dashboardButton.cssClassButtonColour back-widget-set text-center">
                <i class="fa @dashboardButton.cssClassMainImage fa-5x"></i>
                <h3><span id="dashButtonText@index">@dashboardButton.largeText</span>
                    <i class="fa @dashboardButton.cssClassSecondaryImage"></i></h3>
                @dashboardButton.smallText
            </div>
        </a>
    </div>

}

@bodyContent = {
    <div class="row">
        <div class="container-dashboard center-parent">
            <br>
            <br>
        @for((button, index) <- dashButtons.zipWithIndex) {
            @generateDashButton(button, index)
        }
        </div>
    </div>
    <script type="text/javascript">
            var intervalNum;
            $(document).ready(function () {
                intervalNum = window.setInterval(updateDom, 5000)
            });


            var updateDom = function () {
                var link = null,
                        s = "@session().get(user_type.toString)";
                switch (s) {
                    case "CUSTOMER":
                        link = CustomerJSRoutes.controllers.User.CustomerController.getCustomerDashUpdate();
                        break;
                    case "ADMIN":
                        link = AdminJSRoutes.controllers.User.AdminController.getAdminDashUpdate();
                        break;
                    case "KITCHEN":
                        link = KitchenJSRoutes.controllers.User.KitchenStaffController.getKitchenDashUpdate();
                        break;
                    case "DELIVERY":
                        link = DeliveryJSRoutes.controllers.User.DeliveryStaffController.getDeliveryDashUpdate();
                        break;
                    default:
                        alert("Unknown user_type: " + s);
                        break;
                }
                link.ajax({
                    success: function (data) {
                        setText(document.getElementById("dashButtonText0"), data[0].dashButton0);
                        setText(document.getElementById("dashButtonText1"), data[1].dashButton1);
                        setText(document.getElementById("dashButtonText2"), data[2].dashButton2);
                        setText(document.getElementById("dashButtonText3"), data[3].dashButton3);
                    },
                    error: function (error) {
                        alert("Connection lost");
                        clearInterval(intervalNum);
                    }
                });

                function setText(field, text) {
                    field.innerText = text;
                    field.innerHTML = text;
                }
            };

    </script>
}

    @masterOrder.apply(bodyContent)
@**
@masterpage.apply(" :: Dashboard", bodyContent)
**@